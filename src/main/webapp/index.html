<!doctype html><meta charset="utf-8"><title>Відгуки</title>
<h2>Відгуки</h2>
<form id="f" style="margin-bottom:1rem">
    <input name="author" placeholder="Ваше ім'я" required maxlength="64">
    <input name="text"   placeholder="Ваш відгук" required maxlength="1000" style="width:50%">
    <button>Надіслати</button>
</form>
<ul id="list"></ul>
<script>
    async function load() {
        const r = await fetch('comments');
        const data = await r.json();
        const ul = document.getElementById('list');
        ul.innerHTML = '';
        if(!data.length) { ul.innerHTML = '<li>Ще немає відгуків</li>'; return; }
        data.forEach(c => { const li = document.createElement('li');
            li.textContent = `${c.author}: ${c.text}`;
            ul.appendChild(li);
        });
    }
    document.getElementById('f').addEventListener('submit', async (e) => {
        e.preventDefault();
        const fd = new FormData(e.target);
        const body = new URLSearchParams(fd);

        const r = await fetch('comments', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body
        });
        if (r.ok){ e.target.reset(); load(); }
        else alert('Помилка: ' + (await r.text()));
    });

    load();
</script>